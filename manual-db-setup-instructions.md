# Manual Database Setup Instructions

This approach completely bypasses the problematic migrations by manually creating the database and tables.

## What This Approach Does

1. **Drops the existing database** to start fresh
2. **Creates a new database** manually
3. **Creates tables manually** with the correct column types
4. **Marks all migrations as applied** in the migration history
5. **Applies any remaining migrations** (if needed)

## Files Included

1. **manual-db-setup.ps1**: PowerShell script to run the entire process
2. **manual-db-setup.bat**: Windows batch script with the same functionality
3. **create-db.sql**: SQL script to create the database (generated by the scripts)
4. **create-tables.sql**: SQL script to create the tables (generated by the scripts)

## How to Use

### Option 1: Using the PowerShell Script (Recommended)

1. Open PowerShell in the backend directory
2. Run the PowerShell script:
   ```
   .\manual-db-setup.ps1
   ```

### Option 2: Using the Batch Script

1. Open a command prompt in the backend directory
2. Run the batch script:
   ```
   .\manual-db-setup.bat
   ```

### Option 3: Manual Steps

If you prefer to run the steps manually:

1. Drop the existing database:
   ```
   dotnet ef database drop --force
   ```

2. Create a new database using pgAdmin

3. Run the SQL in `create-tables.sql` using pgAdmin

4. Apply the remaining migrations:
   ```
   dotnet ef database update
   ```

## How It Works

This approach completely bypasses the problematic migrations by:

1. Manually creating the database and tables
2. Creating the `Scope` table with the `Type` column already as an integer
3. Marking all migrations as applied in the `__EFMigrationsHistory` table
4. Letting Entity Framework apply any remaining migrations

This is the most direct approach because it doesn't rely on migrations to create the tables with the correct column types.

## If You Don't Have PostgreSQL Command-Line Tools

If you don't have PostgreSQL command-line tools (psql), the script will generate the SQL files for you, and you can run them manually using pgAdmin:

1. Run the script, which will generate `create-db.sql` and `create-tables.sql`
2. Open pgAdmin
3. Connect to your PostgreSQL server
4. Run the SQL in `create-db.sql` to create the database
5. Connect to the newly created database
6. Run the SQL in `create-tables.sql` to create the tables and mark migrations as applied
7. Run `dotnet ef database update` to apply any remaining migrations
